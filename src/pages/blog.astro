---
import Layout from '../layouts/Layout.astro';

// Simulación de artículos del blog
const blogPosts = [
  {
    id: 1,
    title: '¿Qué es RAG y cómo puede transformar tu empresa?',
    excerpt:
      'Descubre cómo la arquitectura RAG (Retrieval-Augmented Generation) puede mejorar la inteligencia artificial de tu empresa con respuestas precisas basadas en tus propios datos.',
    image: '/img/blog/post1.jpg', // Esta imagen se considerará como placeholder, deberá crearse la carpeta y añadir las imágenes
    category: 'Tecnología',
    date: '10 de abril, 2025',
    author: 'Ricardo Huiscafé',
    tags: ['RAG', 'IA', 'Innovación'],
  },
  {
    id: 2,
    title: 'Casos de éxito: Implementación de agentes RAG en PyMEs chilenas',
    excerpt:
      'Conoce historias reales de pequeñas y medianas empresas que han multiplicado su productividad con agentes de IA personalizados.',
    image: '/img/blog/post2.jpg',
    category: 'Casos de Éxito',
    date: '5 de abril, 2025',
    author: 'Ana Martínez',
    tags: ['Casos de éxito', 'PyMEs', 'Chile'],
  },
  {
    id: 3,
    title: 'Comparativa: RAG vs. ChatGPT tradicional',
    excerpt:
      '¿Cuál es la diferencia entre un modelo RAG y un LLM tradicional? Analizamos sus características, ventajas y limitaciones para diferentes casos de uso.',
    image: '/img/blog/post3.jpg',
    category: 'Análisis',
    date: '28 de marzo, 2025',
    author: 'Carlos Pérez',
    tags: ['RAG', 'ChatGPT', 'LLM'],
  },
  {
    id: 4,
    title: '5 maneras de mejorar la atención al cliente con agentes RAG',
    excerpt:
      'Implementa asistentes virtuales que realmente conocen tu negocio y pueden responder consultas específicas de tus clientes con precisión.',
    image: '/img/blog/post4.jpg',
    category: 'Atención al Cliente',
    date: '20 de marzo, 2025',
    author: 'Daniela Rojas',
    tags: ['Servicio al cliente', 'ChatBot', 'IA conversacional'],
  },
  {
    id: 5,
    title: 'Privacidad y seguridad en sistemas RAG: Todo lo que debes saber',
    excerpt:
      'Conoce las mejores prácticas para implementar soluciones RAG que protejan la información confidencial de tu empresa y clientes.',
    image: '/img/blog/post5.jpg',
    category: 'Seguridad',
    date: '15 de marzo, 2025',
    author: 'Ricardo Huiscafé',
    tags: ['Seguridad', 'Privacidad', 'Datos'],
  },
  {
    id: 6,
    title: 'Cómo preparar tus datos para un sistema RAG eficiente',
    excerpt:
      'Guía paso a paso para organizar, limpiar y estructurar tus datos corporativos antes de implementar un agente RAG.',
    image: '/img/blog/post6.jpg',
    category: 'Tutoriales',
    date: '10 de marzo, 2025',
    author: 'Ana Martínez',
    tags: ['Datos', 'Preparación', 'Implementación'],
  },
];

// Obtener todas las categorías únicas
const categories = [...new Set(blogPosts.map((post) => post.category))];

// Define los metadatos de la página
const pageTitle = 'Blog | Agente RAG - Noticias y artículos sobre IA RAG';
const pageDescription =
  'Explora nuestros artículos sobre Inteligencia Artificial RAG, casos de estudio, tutoriales y mejores prácticas para implementar soluciones IA en tu empresa.';
---

<Layout title={pageTitle} description={pageDescription}>
  <div class="page-container">
    <section class="hero-section">
      <h1 class="main-title">Nuestro Blog</h1>
      <p class="subtitle">Artículos, guías y noticias sobre IA RAG</p>
    </section>

    <section class="blog-filters">
      <div class="filter-container">
        <h2>Categorías</h2>
        <div class="categories-list">
          <button class="category-btn active" data-category="all">Todos</button>
          {
            categories.map((category) => (
              <button class="category-btn" data-category={category}>
                {category}
              </button>
            ))
          }
        </div>
      </div>

      <div class="search-container">
        <form class="search-form">
          <input
            type="text"
            placeholder="Buscar artículos..."
            id="search-input"
            class="search-input"
          />
          <button type="submit" class="search-btn">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </button>
        </form>
      </div>
    </section>

    <section class="blog-grid" id="blog-grid">
      {
        blogPosts.map((post) => (
          <article class="blog-card" data-category={post.category} data-tags={post.tags.join(',')}>
            <div class="card-image">
              <div class="image-placeholder" aria-label={post.title} />
              <div class="card-category">{post.category}</div>
            </div>
            <div class="card-content">
              <h2 class="card-title">{post.title}</h2>
              <p class="card-excerpt">{post.excerpt}</p>
              <div class="card-meta">
                <span class="card-date">{post.date}</span>
                <span class="card-author">Por {post.author}</span>
              </div>
              <div class="card-tags">
                {post.tags.map((tag) => (
                  <span class="tag">{tag}</span>
                ))}
              </div>
              <a href={`/blog/${post.id}`} class="read-more">
                Leer más
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M14 5l7 7m0 0l-7 7m7-7H3"
                  />
                </svg>
              </a>
            </div>
          </article>
        ))
      }
    </section>

    <section class="newsletter-section">
      <div class="newsletter-container">
        <div class="newsletter-content">
          <h2>Suscríbete a nuestro newsletter</h2>
          <p>Recibe nuestros artículos, noticias y actualizaciones directamente en tu correo.</p>
        </div>
        <form class="newsletter-form">
          <input type="email" placeholder="Tu correo electrónico" required />
          <button type="submit">Suscribirme</button>
        </form>
      </div>
    </section>

    <div class="pagination">
      <button class="pagination-btn" disabled>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"
          ></path>
        </svg>
        Anterior
      </button>
      <div class="page-numbers">
        <span class="page-number active">1</span>
        <span class="page-number">2</span>
        <span class="page-number">3</span>
      </div>
      <button class="pagination-btn">
        Siguiente
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"
          ></path>
        </svg>
      </button>
    </div>
  </div>
</Layout>

<style>
  .page-container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  .hero-section {
    text-align: center;
    padding: 4rem 0 2rem;
  }

  .main-title {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    background: linear-gradient(45deg, #3b82f6, #8b5cf6);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }

  .subtitle {
    font-size: 1.25rem;
    color: #4b5563;
    margin-bottom: 2rem;
  }

  .blog-filters {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2.5rem;
    flex-wrap: wrap;
    gap: 1.5rem;
  }

  .filter-container h2 {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: #111827;
  }

  .categories-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }

  .category-btn {
    background: #f3f4f6;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 2rem;
    font-size: 0.9rem;
    color: #4b5563;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .category-btn:hover {
    background: #e5e7eb;
  }

  .category-btn.active {
    background: #4f46e5;
    color: white;
  }

  .search-container {
    flex: 1;
    max-width: 400px;
  }

  .search-form {
    display: flex;
    border: 1px solid #d1d5db;
    border-radius: 2rem;
    overflow: hidden;
  }

  .search-input {
    flex: 1;
    padding: 0.75rem 1rem;
    border: none;
    outline: none;
    font-size: 0.95rem;
    background: transparent;
  }

  .search-btn {
    background: transparent;
    border: none;
    padding: 0.75rem 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .search-btn svg {
    width: 1.25rem;
    height: 1.25rem;
    color: #4b5563;
  }

  .blog-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 2rem;
    margin-bottom: 4rem;
  }

  .blog-card {
    background: #ffffff;
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    transition:
      transform 0.3s ease,
      box-shadow 0.3s ease;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .blog-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
  }

  .card-image {
    position: relative;
    height: 200px;
    overflow: hidden;
  }

  .image-placeholder {
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, #e2e8f0, #cbd5e1);
  }

  .card-category {
    position: absolute;
    bottom: 1rem;
    left: 1rem;
    background: rgba(79, 70, 229, 0.9);
    color: white;
    font-size: 0.8rem;
    padding: 0.35rem 0.75rem;
    border-radius: 2rem;
    font-weight: 500;
  }

  .card-content {
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .card-title {
    font-size: 1.4rem;
    font-weight: 700;
    color: #111827;
    margin-bottom: 0.75rem;
    line-height: 1.3;
  }

  .card-excerpt {
    color: #4b5563;
    margin-bottom: 1.5rem;
    line-height: 1.5;
    flex-grow: 1;
  }

  .card-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.85rem;
    color: #6b7280;
    margin-bottom: 1rem;
  }

  .card-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1.25rem;
  }

  .tag {
    background: #f3f4f6;
    font-size: 0.75rem;
    padding: 0.25rem 0.6rem;
    border-radius: 2rem;
    color: #4b5563;
  }

  .read-more {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #4f46e5;
    font-weight: 600;
    font-size: 0.95rem;
    text-decoration: none;
    transition: gap 0.3s ease;
    margin-top: auto;
  }

  .read-more svg {
    width: 1.25rem;
    height: 1.25rem;
    transition: transform 0.3s ease;
  }

  .read-more:hover {
    gap: 0.75rem;
  }

  .read-more:hover svg {
    transform: translateX(2px);
  }

  .newsletter-section {
    margin: 3rem auto;
  }

  .newsletter-container {
    background: linear-gradient(135deg, #4f46e5, #7c3aed);
    border-radius: 1rem;
    padding: 2.5rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 2rem;
    color: white;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  }

  .newsletter-content h2 {
    font-size: 1.8rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
  }

  .newsletter-content p {
    color: rgba(255, 255, 255, 0.9);
    font-size: 1.1rem;
  }

  .newsletter-form {
    display: flex;
    gap: 0.75rem;
    flex: 0 0 40%;
  }

  .newsletter-form input {
    flex: 1;
    padding: 0.75rem 1rem;
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 0.5rem;
    background: rgba(255, 255, 255, 0.1);
    color: white;
    outline: none;
    font-size: 1rem;
  }

  .newsletter-form input::placeholder {
    color: rgba(255, 255, 255, 0.7);
  }

  .newsletter-form input:focus {
    border-color: rgba(255, 255, 255, 0.6);
  }

  .newsletter-form button {
    padding: 0.75rem 1.25rem;
    background: white;
    color: #4f46e5;
    border: none;
    border-radius: 0.5rem;
    font-weight: 600;
    cursor: pointer;
    transition:
      transform 0.3s ease,
      box-shadow 0.3s ease;
  }

  .newsletter-form button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 2rem 0;
    gap: 1rem;
  }

  .pagination-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: white;
    border: 1px solid #d1d5db;
    border-radius: 0.5rem;
    font-weight: 500;
    font-size: 0.95rem;
    color: #111827;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .pagination-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .pagination-btn:not(:disabled):hover {
    background: #f3f4f6;
  }

  .pagination-btn svg {
    width: 1rem;
    height: 1rem;
  }

  .page-numbers {
    display: flex;
    gap: 0.5rem;
  }

  .page-number {
    width: 2.25rem;
    height: 2.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.5rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .page-number:hover {
    background: #f3f4f6;
  }

  .page-number.active {
    background: #4f46e5;
    color: white;
  }

  /* Modo oscuro */
  :global(html[data-theme='dark']) .main-title {
    background: linear-gradient(45deg, #60a5fa, #a78bfa);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }

  :global(html[data-theme='dark']) .subtitle {
    color: #e2e8f0;
  }

  :global(html[data-theme='dark']) .filter-container h2 {
    color: #f3f4f6;
  }

  :global(html[data-theme='dark']) .category-btn {
    background: #374151;
    color: #d1d5db;
  }

  :global(html[data-theme='dark']) .category-btn:hover {
    background: #4b5563;
  }

  :global(html[data-theme='dark']) .category-btn.active {
    background: #6366f1;
  }

  :global(html[data-theme='dark']) .search-form {
    border-color: #4b5563;
  }

  :global(html[data-theme='dark']) .search-input {
    color: #f3f4f6;
  }

  :global(html[data-theme='dark']) .search-btn svg {
    color: #d1d5db;
  }

  :global(html[data-theme='dark']) .blog-card {
    background: #1f2937;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
  }

  :global(html[data-theme='dark']) .image-placeholder {
    background: linear-gradient(45deg, #334155, #475569);
  }

  :global(html[data-theme='dark']) .card-title {
    color: #f9fafb;
  }

  :global(html[data-theme='dark']) .card-excerpt {
    color: #d1d5db;
  }

  :global(html[data-theme='dark']) .card-meta {
    color: #9ca3af;
  }

  :global(html[data-theme='dark']) .tag {
    background: #374151;
    color: #d1d5db;
  }

  :global(html[data-theme='dark']) .read-more {
    color: #818cf8;
  }

  :global(html[data-theme='dark']) .pagination-btn {
    background: #1f2937;
    border-color: #4b5563;
    color: #f3f4f6;
  }

  :global(html[data-theme='dark']) .pagination-btn:not(:disabled):hover {
    background: #374151;
  }

  :global(html[data-theme='dark']) .page-number {
    color: #d1d5db;
  }

  :global(html[data-theme='dark']) .page-number:hover {
    background: #374151;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .blog-filters {
      flex-direction: column;
      align-items: stretch;
      gap: 1.5rem;
    }

    .search-container {
      max-width: 100%;
    }

    .newsletter-container {
      flex-direction: column;
      text-align: center;
      padding: 2rem 1.5rem;
    }

    .newsletter-form {
      width: 100%;
    }
  }

  @media (max-width: 640px) {
    .blog-grid {
      grid-template-columns: 1fr;
    }

    .pagination {
      flex-wrap: wrap;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Filtrado por categorías
    const categoryBtns = document.querySelectorAll('.category-btn');
    const blogPosts = document.querySelectorAll('.blog-card');
    
    categoryBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        // Remover clase activa de todos los botones
        categoryBtns.forEach(b => b.classList.remove('active'));
        
        // Añadir clase activa al botón clickeado
        btn.classList.add('active');
        
        const selectedCategory = btn.getAttribute('data-category');
        
        // Mostrar/ocultar posts según la categoría
        blogPosts.forEach(post => {
          if (selectedCategory === 'all' || post.getAttribute('data-category') === selectedCategory) {
            (post as HTMLElement).style.display = 'block';
          } else {
            (post as HTMLElement).style.display = 'none';
          }
        });
      });
    });

    // Búsqueda
    const searchForm = document.querySelector('.search-form');
    const searchInput = document.getElementById('search-input') as HTMLInputElement | null;
    
    if (searchForm && searchInput) {
      searchForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        const searchTerm = searchInput.value.toLowerCase().trim();
        
        if (!searchTerm) {
          // Si está vacío, mostrar todos los posts
          blogPosts.forEach(post => {
            (post as HTMLElement).style.display = 'block';
          });
          return;
        }
        
        // Filtrar posts por término de búsqueda
        blogPosts.forEach(post => {
          const title = post.querySelector('.card-title')?.textContent?.toLowerCase() || '';
          const excerpt = post.querySelector('.card-excerpt')?.textContent?.toLowerCase() || '';
          const tags = post.getAttribute('data-tags')?.toLowerCase() || '';
          
          if (title.includes(searchTerm) || excerpt.includes(searchTerm) || tags.includes(searchTerm)) {
            (post as HTMLElement).style.display = 'block';
          } else {
            (post as HTMLElement).style.display = 'none';
          }
        });
      });
    }
    
    // Formulario de Newsletter
    const newsletterForm = document.querySelector('.newsletter-form');
    
    if (newsletterForm) {
      newsletterForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        const email = (newsletterForm.querySelector('input') as HTMLInputElement)?.value.trim();
        
        if (email) {
          alert('¡Gracias por suscribirte a nuestro newsletter!');
          (newsletterForm as HTMLFormElement).reset();
        }
      });
    }
    
    // Paginación (ejemplo simplificado)
    const pageNumbers = document.querySelectorAll('.page-number');
    
    pageNumbers.forEach(pageNumber => {
      pageNumber.addEventListener('click', () => {
        pageNumbers.forEach(p => p.classList.remove('active'));
        pageNumber.classList.add('active');
        
        // Aquí se implementaría la lógica real de paginación
      });
    });
  });
</script>
