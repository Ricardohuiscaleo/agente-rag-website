const v=document.querySelectorAll(".nav-item-container"),R=document.querySelectorAll(".nav-item-container .nav-link"),W=document.querySelectorAll("section.content-section"),a={};v.forEach(t=>{const e=t.getAttribute("data-section");e&&(a[e]=[])});W.forEach(t=>{const e=t.id;for(const n in a)if(e===n||e.startsWith(n+"-")){a[n].push(t);break}});function G(t){const e=a[t];if(!e||e.length===0)return 0;const n=e[0],i=e[e.length-1];return i.offsetTop+i.offsetHeight-n.offsetTop}function $(){if(!(window.innerWidth<=768))return;const e=document.querySelector(".nav-item-container")?.parentElement;if(!e)return;const n=window.scrollY||document.documentElement.scrollTop,i=document.documentElement.scrollHeight-window.innerHeight,c=Math.max(0,Math.min(1,n/i)),r=e.scrollWidth-e.clientWidth,d=c*r;e.scrollTo({left:d,behavior:"auto"})}function P(t){if(window.innerWidth<=768)return;const n=document.querySelector(".sidebar");if(!n)return;const i=t.getBoundingClientRect(),c=n.getBoundingClientRect(),r=i.top<c.top,d=i.bottom>c.bottom;if(r||d){const h=t.offsetTop,p=n.clientHeight,u=t.clientHeight,y=h-p/2+u/2;n.scrollTo({top:y,behavior:"smooth"})}}function g(){let t=null,e=null,n=null,i=0;W.forEach(o=>{const l=o.getBoundingClientRect(),s=Math.min(l.bottom,window.innerHeight)-Math.max(l.top,0);s>i&&(i=s,t=o.id,e=o)});let c=0,r=0;const d={};for(const o in a){const l=G(o);d[o]=l,c+=l;const s=a[o].length;s>r&&(r=s)}const h=100,p=450,u=120,y=500,m=window.innerWidth<=768;m&&$(),v.forEach(o=>{const l=o.getAttribute("data-section"),s=o.querySelector(".progress-indicator");if(o.querySelector(".nav-link"),!l)return;if(l==="usage"){o.style.display="none";return}o.classList.remove("active"),s&&(s.style.opacity="0"),m?(o.style.width=`${u}px`,o.style.height="40px"):(o.style.height=`${h}px`,o.style.width="");let b=!1;if(t&&(b=t===l||t.startsWith(l+"-")),b&&(o.classList.add("active"),n=o,e&&s)){const f=a[l];if(f&&f.length>0){const T=d[l]||0,A=f.length,E=T/c,S=A/r;let w;m?w=E*.2+S*1.8:w=E*.9+S*.4;const k=h+w*(p-h),B=u+w*(y-u),H=Math.min(Math.max(k,h),p),x=Math.min(Math.max(B,u),y);m?(o.style.width=`${Math.round(x)}px`,o.style.minWidth=`${Math.round(x)}px`,o.style.height="40px",o.hasAttribute("data-user-clicked")&&o.removeAttribute("data-user-clicked")):(o.style.height=`${Math.round(H)}px`,o.style.width="",o.style.minWidth=""),s.style.opacity="1";const I=f[0],M=f[f.length-1],C=window.scrollY-I.offsetTop,q=M.offsetTop+M.offsetHeight-I.offsetTop,N=Math.max(0,Math.min(1,C/q));if(m)s.style.display="none";else{s.style.display="";const V=N*(H-s.offsetHeight);s.style.top=`${V}px`,s.style.transform=""}}}}),n&&P(n)}window.addEventListener("scroll",g);window.addEventListener("load",g);window.addEventListener("resize",g);window.addEventListener("scroll",$);function L(){if(window.innerWidth<=768){const t=document.querySelector(".nav-item-container")?.parentElement;if(t){t.style.display="flex",t.style.flexWrap="nowrap",t.style.overflowX="auto",t.style.scrollbarWidth="none",t.style.msOverflowStyle="none",t.style.width="100%",t.style.paddingBottom="12px";const e=document.createElement("style");e.textContent=`
          ${t.tagName.toLowerCase()}${t.id?"#"+t.id:""} {
            scrollbar-width: none;
          }
          ${t.tagName.toLowerCase()}${t.id?"#"+t.id:""}::-webkit-scrollbar {
            display: none;
          }
        `,document.head.appendChild(e)}}}window.addEventListener("load",L);window.addEventListener("resize",L);v.forEach(t=>{t.addEventListener("click",e=>{if(!e.target.closest(".nav-link")){e.preventDefault(),t.setAttribute("data-user-clicked","true");const i=t.querySelector(".nav-link")?.getAttribute("href")?.substring(1);if(i){const c=document.getElementById(`${i}-intro`)||document.getElementById(`${i}-part1`)||document.getElementById(i)||document.getElementById(`${i}-home`);c&&(c.scrollIntoView({behavior:"smooth"}),setTimeout(g,700))}}})});R.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const n=t.getAttribute("href")?.substring(1);if(n){const i=document.getElementById(`${n}-intro`)||document.getElementById(`${n}-part1`)||document.getElementById(n)||document.getElementById(`${n}-home`);i&&(i.scrollIntoView({behavior:"smooth"}),setTimeout(g,700))}})});
